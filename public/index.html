<html>
  <script>
    //global variable
    let hang = 0;
    let PossibleWords = [
"shabby",
"zippy",
"blue in the face",
"ignorance is bliss",
"knee jerk reaction",
"my Achilles heel",
"cog in the machine",
"hold your horses",
"burning the midnight oil",
"the world’s my oyster",
"don’t muddy the waters",
"upset the apple cart",
"hot cherry pie slice",
"a castiron stomach",
"batten down hatches",
"point of view",
"shiver me timbers"
]
    function hide(key) {
      
      document.getElementById(key).style.display = 'none'
    }
    //Updates hangman display depending on hang value
    function UpdateHang(){
      let src = "hang"+hang+".png"
        document.getElementById("hang").src = src;
      
    }
    //Hides the whole word given replacing characters with '_'
    function HideWord(word){
      let hiddenWord = ""
      for(let i = 0;i<word.length;i++){
        if(word.charAt(i) == ' '){
          hiddenWord += ' ';
        }else{
          hiddenWord += '_';
        }
      }
      return hiddenWord;
    }
    //This is ONLY USED BY INITIALIZE WORD to display a word that it initializes
    function DisplayWord(word,display){
      let part = ''; // the location to displaythe word
      switch (display) {
  case 0:
    part = "word1";
    break;
  case 1:
  part = "word2";
    break;
  case 2:
  part = "word3";
    break;
    case 3:
  part = "word4";
    break;

  default:
}
document.getElementById(part).textContent = word;
}
    
    //Displays the entirety of the word given where a space corresponds to a new row
    function InitializeWord(word){
      
      let display = 0;
      let newWord ='';
        for (let i = 0; i<word.length;i++){
          let c = word.charAt(i);
          c = c.toUpperCase();
          if(c != ' '){
            newWord += c + ' ';
          }else{
            DisplayWord(newWord,display)
            display++;
            newWord ='';
            if(display > 4){
            break;
          }
          }
          
          
        }
        if(newWord != ''){
          DisplayWord(newWord,display);
        }
      }
      /*
      reader.onload = () => {
  const fileContents = reader.result;
  console.log(fileContents);
};
*/
  //picks a random word to be the word for the hangman game
      function PickWord(){
        
        let randomNumber = Math.floor(Math.random() * PossibleWords.length);
        return PossibleWords[randomNumber];
        
      }
      //Reveals the letter of the key pressed
      function UpdateWord(key){
        let atleastOne = false;
        let newWord = "";
        for(let i = 0;i<hangManWord.length;i++){
          if(hangManWord.charAt(i).toUpperCase() == key){
            newWord += key;
            atleastOne = true;
          }else{
            newWord += hiddenWord.charAt(i);
          }
        }
        if(atleastOne){
          hiddenWord = newWord;
          InitializeWord(hiddenWord);
          //CheckIfWin();

        }else{
          hang++;
          UpdateHang();
          //CheckIfLose()
        }

      }
     

    
  </script>
  <style>
    div {
      font-size: 175%;
    }
    .vertical-line {
      border-left: 5px solid black;
      height: 100%;
    }
    .horizontal-line {
      border-top: 5px solid black;
      width: 100%;
    }
    .key {
      font-family: 'Comic Sans MS', cursive, sans-serif;
      font-size: 450%;
      padding-left: 1.5%;
	padding-right: 1.5%;
    }
    .key:hover {
      font-size: 600%;
      color: red;
      cursor: pointer;
    }
  </style>
  <head>
    <title>HangMan Game</title>
    <div id="TopMostSection">
		<div id = "Timer" style="display: inline-block;"> Timer: 30 </div>
      <div id = "Role" style="display: inline-block;position: absolute; left: 80%;">
        Role: Guesser
      </div>
    </div>

    <div align="center" id="heading">Player 1's Turn</div>
    <br />
    <div class="horizontal-line"></div>

	<div class = vertical-line style = "position: absolute; left:76%; bottom: 0px;"></div>

    <div style = "font-size: 300%; padding-left: 5%; font-family: 'Comic Sans MS', cursive, sans-serif;">
     <div id = "word1"></div>
  
      <div id = "word2"></div>
      
      <div id = "word3"></div>
      
      <div id = "word4"></div>
    </div>
	<img id = "hang" src = "" style = " position: absolute;left: 78%; bottom: 25%" width= 400 > </img>
    <br />
    <br />
    <br />
    <br />
    <br />
    <br />
    <div class="horizontal-line" style="width: 76.3%"></div>
    <span class="key" id="A" onclick="onClick('A')">A</span>
    <span class="key" id="B" onclick="onClick('B')">B</span>
    <span class="key" id="C" onclick="onClick('C')">C</span>
    <span class="key" id="D" onclick="onClick('D')">D</span>
    <span class="key" id="E" onclick="onClick('E')">E</span>
    <span class="key" id="F" onclick="onClick('F')">F</span>
    <span class="key" id="G" onclick="onClick('G')">G</span>
    <span class="key" id="H" onclick="onClick('H')">H</span>
    <span class="key" id="I" onclick="onClick('I')">I</span>
    <span class="key" id="J" onclick="onClick('J')">J</span>
    <span class="key" id="K" onclick="onClick('K')">K</span>
    <span class="key" id="L" onclick="onClick('L')">L</span>
    <span class="key" id="M" onclick="onClick('M')">M</span>
    <br />
    <br />
    <span class="key" id="N" onclick="onClick('N')">N</span>
    <span class="key" id="O" onclick="onClick('O')">O</span>
    <span class="key" id="P" onclick="onClick('P')">P</span>
    <span class="key" id="Q" onclick="onClick('Q')">Q</span>
    <span class="key" id="R" onclick="onClick('R')">R</span>
    <span class="key" id="S" onclick="onClick('S')">S</span>
    <span class="key" id="T" onclick="onClick('T')">T</span>
    <span class="key" id="U" onclick="onClick('U')">U</span>
    <span class="key" id="V" onclick="onClick('V')">V</span>
    <span class="key" id="W" onclick="onClick('W')">W</span>
    <span class="key" id="X" onclick="onClick('X')">X</span>
    <span class="key" id="Y" onclick="onClick('Y')">Y</span>
    <span class="key" id="Z" onclick="onClick('Z')">Z</span>
    <!-- These two elements are temporary. I only put them here to check if the socket.io is working properly -->
    <div id="lose-message" style="display: none">You Lose!</div>
    <div id="win-message" style="display: none">You Won!</div>
    <script src="/socket.io/socket.io.js"></script>
    <script>
      const urlAddress = window.location.href
      const teamId = urlAddress.substring(urlAddress.lastIndexOf('/') + 1)
      //var socket = io()
      function onClick(key) {
        //socket.emit('keyPressed', key, teamId)
        hide(key)
        UpdateWord(key)
      }
      /*
    socket.on('keyPressed', (tempKey, tempTeamId) => {
        if (tempTeamId == teamId) {
          document.getElementById(tempKey).style.display = 'none'
        }
      })
    */
   /*
      // Listen for the "endGame" message from the server
      socket.on('endGame', (result, tempTeamId) => {
        if (tempTeamId == teamId) {
          if (result == 'LOSE') {
            // Show the "You lose" message. We might have this on a separate page in the future
            document.getElementById('lose-message').style.display = 'block'
          } else {
            // Show the "You won" message. We might have this on a separate page in the future
            document.getElementById('win-message').style.display = 'block'
          }
        }
      })
      window.onbeforeunload = function(e) {
        return "Do you want to exit this page?";
      }; 
    */
    </script>
    <script>
      // THIS PORTION IS MEANT FOR INITIALIZING HANG MAN WORD AT START OF GAME
      UpdateHang();
      let hangManWord = PickWord();
      let hiddenWord = HideWord(hangManWord);
      InitializeWord(hiddenWord);
      
    </script>
  </head>

  
</html>
